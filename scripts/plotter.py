import matplotlib.pyplot as plt
import numpy as np

print "calculating binomials..."


if 0:
    X = 8
    l = 26
    c = 8
    ck = 6
    
    Mess = [x * 10 for x in range(31)]
    
    
    plt.plot([15, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300],
             [0.0, 0.0, 2.9999999999999997e-05, 3e-05, 9.5e-05, 0.00021500000000000008, 0.0004700000000000003, 0.0006100000000000003, 0.0012049999999999982, 0.0018549999999999916, 0.002879999999999976, 0.004614999999999954, 0.006449999999999921, 0.008554999999999922, 0.012050000000000045, 0.01715000000000014, 0.022420000000000183, 0.028960000000000104, 0.036655000000000174, 0.04569000000000022],
            "--", marker='x', label="c: " + str(c) + ", ck: " + str(ck) + ", l: " + str(l) + " (alea)")
             
    plt.xlabel("Number of learnt messages (M)")
    plt.ylabel("Error rate")
    
    #plt.plot([100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
    #         [0.0017, 0.00445, 0.00565, 0.0121, 0.031, 0.0639, 0.10655, 0.19375, 0.2618, 0.3404, 0.44675],
    #        "-", marker='*', label="c: " + str(c) + ", ck: " + str(ck) + ", l: " + str(l) + " (2 layers)")
            
    plt.plot([100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
             [0.0023, 0.0021, 0.00315, 0.0062, 0.0093, 0.0178, 0.0327, 0.053, 0.07225, 0.1132, 0.16055],
            "-", marker='*', label="c: " + str(c) + ", ck: " + str(ck) + ", l: " + str(l) + " (2 layers, improved)")
            
    plt.plot([100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
             [0.0023, 0.0017, 0.00275, 0.0052, 0.0071, 0.0112, 0.01655, 0.02175, 0.0291, 0.045, 0.0611],
            "-", marker='^', label="c: " + str(c) + ", ck: " + str(ck) + ", l: " + str(l) + " (code layer, strict)")
    
    plt.plot([10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
             [0, 0.0013, 0.0045, 0.01395, 0.02225, 0.0375, 0.0594, 0.09075, 0.1008, 0.15775, 0.1883, 0.217, 0.2502, 0.2999, 0.3205, 0.3632, 0.38875, 0.42475, 0.44895, 0.4916],
            "-", marker='v', label="c: " + str(c) + ", ck: " + str(ck) + ", l: " + str(l) + " (mono-layer)")
            
    plt.gca().grid(True)
    plt.yticks(np.arange(0, 0.5, 0.05))
    plt.legend(loc="upper left")

###Iterations

Mess = [x*1000 for x in range(1, 31)]

Y0 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0003, 0.0003, 0.0006000000000000001, 0.001, 0.0028000000000000004, 0.005900000000000002, 0.009100000000000004, 0.013400000000000007, 0.022700000000000012, 0.03379999999999999, 0.05720000000000001, 0.08210000000000002, 0.12270000000000003, 0.17399999999999996, 0.24859999999999996, 0.31779999999999997, 0.42850000000000016, 0.5352, 0.6455999999999998, 0.7597999999999999]

Y40 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0004, 0.001, 0.0016, 0.0027999999999999995, 0.0052000000000000015, 0.012800000000000004, 0.01640000000000001, 0.024800000000000013, 0.03280000000000002, 0.05180000000000001, 0.1088, 0.2254000000000001, 0.4056, 0.6137999999999999, 0.7716, 0.8839999999999998, 0.939, 0.9686000000000001, 0.9855999999999997, 0.9925999999999999, 0.9954, 0.9980000000000001, 0.9989999999999999, 0.9990000000000001, 0.9988000000000002]
Y40 = [0.0, 0.0, 0.0, 0.000125, 0.0, 0.0005, 0.0012499999999999998, 0.0027500000000000007, 0.004500000000000001, 0.006500000000000003, 0.008000000000000002, 0.012125000000000006, 0.01762500000000001, 0.024750000000000015, 0.03924999999999999, 0.07587500000000001, 0.14512499999999998, 0.27199999999999996, 0.44412499999999994, 0.6124999999999997, 0.7723750000000001, 0.8708750000000001, 0.9395, 0.968375, 0.9843749999999998, 0.9921249999999999, 0.9956249999999998, 0.99725, 0.9989999999999999, 0.999]

Y50 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0004, 0.0002, 0.0004, 0.0012000000000000001, 0.0018, 0.0038000000000000013, 0.006800000000000001, 0.012600000000000005, 0.015200000000000007, 0.027200000000000016, 0.03840000000000002, 0.06480000000000001, 0.11580000000000001, 0.2184000000000001, 0.39640000000000003, 0.5838, 0.7541999999999999, 0.8683999999999996, 0.9376000000000001, 0.968, 0.9839999999999995, 0.9895999999999998, 0.9958, 0.997, 0.9982]
Y50 = [0.0, 0.0, 0.0, 0.0, 0.00025, 0.000125, 0.0005, 0.0016250000000000001, 0.0014999999999999996, 0.0025000000000000005, 0.005500000000000002, 0.007250000000000002, 0.011000000000000006, 0.01712500000000001, 0.024625000000000015, 0.035, 0.04825, 0.07537500000000001, 0.12262500000000001, 0.21749999999999997, 0.352625, 0.4909999999999998, 0.6631250000000002, 0.7862500000000001, 0.8768749999999997, 0.930625, 0.9666249999999998, 0.9861249999999998, 0.9917499999999997, 0.996875]
Y50 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0008750000000000001, 0.0005, 0.000625, 0.0022500000000000003, 0.004000000000000001, 0.0046250000000000015, 0.0065000000000000014, 0.011625000000000003, 0.01787500000000001, 0.025500000000000016, 0.03100000000000001, 0.037750000000000006, 0.06325, 0.08500000000000002, 0.13349999999999995, 0.21825, 0.3522500000000001, 0.517625, 0.676375, 0.8011250000000001, 0.89175, 0.9471250000000001, 0.9743750000000002, 0.987125, 0.9936249999999998]


Y80 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0006, 0.0002, 0.0004, 0.001, 0.0026, 0.0036, 0.008, 0.011600000000000006, 0.01880000000000001, 0.028000000000000014, 0.051400000000000015, 0.0858, 0.1654, 0.2706, 0.4222000000000001, 0.6200000000000001, 0.7578, 0.8704000000000001, 0.9469999999999998, 0.9723999999999999, 0.9871999999999999]
Y80 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.000125, 0.00025, 0.000625, 0.0022500000000000003, 0.001875, 0.003125, 0.006750000000000002, 0.007125000000000002, 0.013875000000000007, 0.01825000000000001, 0.030625000000000006, 0.04324999999999999, 0.06974999999999999, 0.09662500000000002, 0.13200000000000003, 0.17012500000000003, 0.23200000000000004, 0.295125, 0.360875, 0.4646250000000001, 0.55125, 0.6539999999999999, 0.7422500000000002, 0.8143749999999998]
Y80 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.000125, 0.00025, 0.000625, 0.000625, 0.0014999999999999998, 0.0026250000000000006, 0.002375000000000001, 0.005875000000000001, 0.009625000000000005, 0.013500000000000007, 0.021250000000000012, 0.0315, 0.0465, 0.06412500000000002, 0.09562500000000002, 0.12450000000000001, 0.16187499999999994, 0.20575000000000002, 0.26599999999999996, 0.33187500000000003, 0.4185, 0.5001249999999999, 0.5918750000000002, 0.6806249999999999, 0.7727500000000002]

XD = [50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000, 2050, 2100, 2150, 2200, 2250, 2300, 2350, 2400, 2450, 2500, 2550, 2600, 2650, 2700, 2750, 2800, 2850, 2900, 2950, 3000]
YD = [0.0016000000000000003, 0.008400000000000005, 0.02894999999999999, 0.045849999999999974, 0.07104999999999999, 0.09015, 0.12110000000000001, 0.15065, 0.17779999999999993, 0.21044999999999997, 0.23180000000000003, 0.25804999999999995, 0.2832000000000001, 0.30604999999999993, 0.32739999999999986, 0.3494, 0.36735000000000007, 0.3953, 0.4078499999999998, 0.4273500000000001, 0.44614999999999994, 0.45760000000000006, 0.47590000000000016, 0.4870999999999998, 0.5050500000000001, 0.5185000000000002, 0.5317500000000002, 0.5465499999999999, 0.5606, 0.5780999999999998, 0.5826500000000001, 0.5961000000000001, 0.6022, 0.6187499999999996, 0.6235999999999998, 0.6286999999999999, 0.6422500000000002, 0.6444999999999997, 0.6598999999999997, 0.67035, 0.6732500000000001, 0.6801499999999997, 0.6872500000000001, 0.69705, 0.7001500000000002, 0.714, 0.715, 0.7237000000000003, 0.7241000000000003, 0.7313500000000001, 0.7365999999999999, 0.7456999999999998, 0.7512500000000004, 0.7484000000000002, 0.7558000000000001, 0.758, 0.77015, 0.76865, 0.77125, 0.7827500000000001]
YE = [0.0027000000000000006, 0.027249999999999983, 0.08760000000000004, 0.16819999999999993, 0.25654999999999994, 0.3538499999999999, 0.4297000000000002, 0.5108000000000001, 0.5706499999999999, 0.6318500000000001, 0.6838, 0.7195500000000001, 0.7605500000000002, 0.7904499999999999, 0.8138000000000005, 0.8326499999999999, 0.8551499999999996, 0.8736999999999999, 0.8878500000000001, 0.8957000000000008, 0.9100500000000004, 0.9189000000000006, 0.9263500000000005, 0.93355, 0.9416999999999998, 0.9453499999999998, 0.9464000000000002, 0.9552499999999998, 0.9596499999999996, 0.9612999999999998, 0.9637499999999993, 0.9671499999999997, 0.9703499999999999, 0.9722999999999999, 0.9750499999999992, 0.9775999999999994, 0.9764999999999996, 0.9781499999999993, 0.9808, 0.9819499999999992, 0.982799999999999, 0.9843999999999997, 0.9865999999999998, 0.9861999999999996, 0.9855499999999996, 0.9866499999999995, 0.9892999999999997, 0.9887499999999999, 0.9884999999999995, 0.9899000000000002, 0.9907499999999998, 0.9902999999999997, 0.9916999999999999, 0.9922499999999999, 0.9920500000000003, 0.9930500000000002, 0.9930499999999997, 0.9943000000000001, 0.9941000000000001, 0.99395]
YI = [0.0002, 0.0019, 0.005400000000000003, 0.012349999999999998, 0.022699999999999977, 0.032799999999999996, 0.04950000000000001, 0.06734999999999998, 0.08055000000000004, 0.09700000000000004, 0.11299999999999999, 0.13019999999999998, 0.14799999999999996, 0.16434999999999994, 0.1789000000000001, 0.18955, 0.20200000000000012, 0.22714999999999996, 0.23329999999999998, 0.24819999999999998, 0.2598999999999999, 0.27740000000000004, 0.29469999999999996, 0.29745000000000005, 0.3093, 0.3240999999999999, 0.3327499999999998, 0.3478, 0.35075, 0.36269999999999997, 0.37424999999999997, 0.3822500000000002, 0.39265000000000005, 0.40145000000000003, 0.4094, 0.41245000000000004, 0.4241499999999999, 0.4302999999999998, 0.4439499999999999, 0.44794999999999996, 0.45404999999999995, 0.46240000000000003, 0.4677999999999999, 0.4745000000000001, 0.4801, 0.48885000000000006, 0.4998, 0.5030000000000002, 0.5058500000000001, 0.5128999999999999, 0.5185500000000001, 0.5213499999999999, 0.5324500000000001, 0.5321500000000001, 0.5377999999999998, 0.5412999999999999, 0.5328499999999998, 0.5489000000000002, 0.5599999999999999, 0.5577000000000001]
XB = [25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 525, 550, 575, 600, 625, 650, 675, 700, 725, 750, 775, 800, 825, 850, 875, 900, 925, 950, 975, 1000]
YB = [0.0, 0.00025, 0.0016500000000000004, 0.004300000000000002, 0.008150000000000004, 0.020799999999999992, 0.04655000000000001, 0.0791, 0.13709999999999994, 0.19039999999999996, 0.2557000000000001, 0.32765000000000005, 0.4056499999999998, 0.47700000000000004, 0.5267499999999999, 0.5992000000000001, 0.6452, 0.6969000000000001, 0.72985, 0.7692999999999999, 0.7989, 0.8237499999999999, 0.84185, 0.8586499999999995, 0.87205, 0.8888499999999996, 0.9023500000000005, 0.91185, 0.9174499999999997, 0.9277999999999997, 0.9361000000000003, 0.9409500000000002, 0.9447999999999999, 0.9487499999999995, 0.95115, 0.9532999999999993, 0.9578999999999995, 0.9599499999999995, 0.9643499999999996, 0.96435]

if 0:
    plt.plot(XD, YD, marker="^", label="25% erasure")
    plt.plot(XD, YE, marker="x", label="25% errors")
    plt.plot(XD, YI, marker="s", label="25% insertions")
    plt.plot(XB, YB, marker="v", label="full blur")

if 1:
    plt.plot(Mess, 
             [0.015141585500000014, 0.030058610999999975, 0.04474464, 0.0592122815, 0.07345905549999998, 0.08748733450000007, 0.10130246500000001, 0.11491860000000001, 0.12832443, 0.14152174000000003, 0.15452304000000008, 0.16731655500000003, 0.17992871499999996, 0.19234925999999997, 0.20455970000000007, 0.21662318999999994, 0.22849283999999995, 0.24016668000000008, 0.25167680000000003, 0.263010945, 0.2741688550000001, 0.285146705, 0.29598689999999994, 0.3066501299999999, 0.3171455499999999, 0.32749828000000003, 0.337681255, 0.3477074299999998, 0.3575804200000001, 0.36730316499999993],
            "--", label="density")
    
    #plt.plot(Mess, 
    #         [0.0, 0.0, 0.0, 0.0, 0.0, 5e-05, 0.0001, 0.00030000000000000003, 0.0006999999999999999, 0.0012000000000000003, 0.002600000000000001, 0.004100000000000003, 0.009100000000000007, 0.013849999999999973, 0.023449999999999954, 0.03834999999999994, 0.05724999999999996, 0.09075000000000003, 0.12075000000000005, 0.1792500000000002, 0.2402000000000001, 0.3226, 0.4017999999999999, 0.49550000000000005, 0.5852999999999998, 0.6717, 0.7425499999999997, 0.8043000000000003, 0.8578500000000004, 0.8986499999999998],
    #        "-", marker='^', label="no noise")
            
    Y0_10 = [0.0, 0.0, 0.0, 5e-05, 0.0001, 0.0, 5e-05, 0.0001, 0.0008500000000000001, 0.0011500000000000002, 0.0019000000000000006, 0.002750000000000001, 0.004650000000000002, 0.007000000000000004, 0.01255, 0.018699999999999994, 0.02970000000000001, 0.046349999999999995, 0.07055, 0.10610000000000003, 0.16190000000000002, 0.22449999999999992, 0.30695000000000006, 0.39745000000000014, 0.49920000000000003, 0.5846500000000002, 0.69235, 0.7587499999999998, 0.8218999999999999, 0.8727000000000001]
    Y0_3succ = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00015, 0.00030000000000000003, 0.00030000000000000003, 0.0009500000000000001, 0.0019000000000000009, 0.002500000000000001, 0.005100000000000004, 0.007900000000000004, 0.011700000000000002, 0.02239999999999998, 0.031199999999999988, 0.05234999999999998, 0.07695, 0.11760000000000001, 0.16329999999999995, 0.23835000000000003, 0.32395, 0.41595000000000026, 0.5127000000000002, 0.6041000000000001, 0.6915000000000002, 0.7637500000000002, 0.8334, 0.88]
    plt.plot(Mess,Y0_3succ,"-", marker ="^", label = "no noise")
            
    #plt.plot(Mess, Y40,"-", marker='x', label="nsyn = 10, prel=0.4")
            
    plt.plot(Mess, 
             Y50,
            "-", marker='s', label="nsyn = 10, prel=0.5")
            
    plt.plot(Mess, Y80,"-", marker='v', label="nsyn = 10, prel=0.8")

    Y50_20SYN_100 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0002, 0.0004, 0.0006, 0.0010500000000000002, 0.002250000000000001, 0.003750000000000002, 0.007200000000000004, 0.011499999999999995, 0.015349999999999961, 0.023599999999999937, 0.033399999999999944, 0.04664999999999996, 0.06279999999999995, 0.08304999999999994, 0.12085000000000007, 0.1702500000000002, 0.23590000000000003, 0.33080000000000015, 0.44694999999999985, 0.5805500000000001, 0.6968000000000003, 0.8043500000000006, 0.8856499999999996, 0.9358499999999998]
    Y50_20SYN_200 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0005, 0.00075, 0.001125, 0.0021249999999999997, 0.004875, 0.006875000000000001, 0.010500000000000006, 0.016500000000000008, 0.023625000000000014, 0.035250000000000004, 0.04775, 0.06312499999999999, 0.08075000000000002, 0.11100000000000002, 0.14562499999999998, 0.199375, 0.2725000000000001, 0.35037500000000005, 0.47275, 0.5891250000000001, 0.7163749999999995, 0.81925, 0.8983749999999999]

    plt.plot(Mess, Y50_20SYN_200, "-", marker='*', label="nsyn = 20, prel=0.5")
        
plt.xlabel("Number of learnt messages (M)")
plt.ylabel("Error rate, density")    
plt.gca().grid(True)
plt.yticks(np.arange(0, 1.1, 0.1))
plt.legend(loc="upper left")